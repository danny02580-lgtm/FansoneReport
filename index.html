<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FansOne Monthly Report</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
    }
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at top, #0f172a 0, #020617 45%, #000 100%);
      color: #e5e7eb;
    }
    .shell {
      max-width: 1120px;
      margin: 0 auto;
      padding: 20px 16px 32px;
    }

    /* Top bar */
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(148,163,184,0.3);
      margin-bottom: 18px;
      backdrop-filter: blur(16px);
    }
    .topbar-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .badge-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #22c55e, #16a34a);
      box-shadow: 0 0 12px rgba(34,197,94,0.8);
    }
    .top-title {
      font-size: 16px;
      font-weight: 600;
    }
    .top-sub {
      font-size: 12px;
      color: #9ca3af;
    }
    .topbar-right {
      font-size: 11px;
      color: #9ca3af;
      text-align: right;
    }

    h1 {
      margin: 8px 0 8px;
      font-size: 22px;
      letter-spacing: 0.02em;
    }
    .subtitle {
      margin-bottom: 18px;
      color: #9ca3af;
      font-size: 13px;
    }

    .layout {
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: stretch;
    }

    .card {
      background: rgba(2, 6, 23, 0.95);
      border-radius: 14px;
      padding: 16px 18px 16px;
      box-shadow: 0 0 0 1px rgba(30,64,175,0.5), 0 18px 45px rgba(15,23,42,0.9);
    }
    .card h2 {
      margin: 0 0 10px;
      font-size: 17px;
    }

    .table-wrapper {
      max-width: 100%;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      min-width: 900px;
    }
    thead {
      background: #0f172a;
    }
    th, td {
      padding: 6px 8px;
      text-align: right;
      white-space: nowrap;
    }
    th {
      color: #e5e7eb;
      font-weight: 500;
    }
    td {
      color: #d1d5db;
    }
    th:first-child,
    td:first-child {
      text-align: left;
      position: sticky;
      left: 0;
      background: #020617;
    }
    tr:nth-child(even) td {
      background: #020617;
    }
    tr:nth-child(odd) td {
      background: #020617;
    }

    .tag {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 600;
    }
    .tag-sp {
      background: rgba(250, 204, 21, 0.12);
      color: #facc15;
    }
    .tag-total {
      background: rgba(248, 113, 113, 0.18);
      color: #fca5a5;
    }
    .kpi-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 8px;
      font-size: 13px;
    }
    .kpi-label {
      color: #9ca3af;
      margin-right: 4px;
    }
    .kpi-value {
      font-weight: 600;
      margin-right: 12px;
    }
    .muted {
      color: #6b7280;
      font-size: 12px;
    }

    .chart-section {
      margin-top: 4px;
    }
    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 12px;
      flex-wrap: wrap;
    }
    .chart-header h2 {
      font-size: 17px;
      margin: 0;
    }
    .chart-controls {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      justify-content: flex-end;
    }
    .chart-controls-label {
      color: #9ca3af;
      margin-right: 4px;
      font-size: 11px;
    }
    .group-toggle {
      display: flex;
      align-items: center;
      gap: 4px;
      color: #e5e7eb;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(15,23,42,0.9);
      border: 1px solid transparent;
      cursor: pointer;
      user-select: none;
    }
    .group-toggle input {
      accent-color: #22c55e;
    }
    .group-toggle:hover {
      border-color: rgba(148,163,184,0.7);
    }

    .chart-legend-hint {
      margin-top: 6px;
      font-size: 11px;
      color: #6b7280;
    }

    canvas {
      background: radial-gradient(circle at top, #020617 0, #020617 50%, #020617 100%);
      border-radius: 12px;
      box-shadow: 0 0 0 1px rgba(30,64,175,0.6);
      padding: 8px;
    }

    @media (max-width: 768px) {
      .topbar {
        flex-direction: column;
        align-items: flex-start;
        border-radius: 16px;
      }
      .topbar-right {
        text-align: left;
      }
      .card {
        padding: 14px 12px 14px;
      }
      h1 {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="topbar">
      <div class="topbar-left">
        <div class="badge-dot"></div>
        <div>
          <div class="top-title">FansOne Monthly Report</div>
          <div class="top-sub">Subscription performance, single-purchase insight, ARPU overview.</div>
        </div>
      </div>
      <div class="topbar-right">
        <div>Last update: 2025-12-11</div>
        <div>Data range: 2025-06 ~ 2025-11</div>
      </div>
    </div>

    <h1>æœˆåº¦è¨‚é–± & å–®ç‰‡è³¼è²·å ±è¡¨ï¼ˆ6â€“11 æœˆï¼‰</h1>
    <div class="subtitle">
      ã€Œç‡Ÿæ”¶é‡‘é¡ã€åƒ…ä»£è¡¨è¨‚é–±ç‡Ÿæ”¶ï¼Œ<b>å–®ç‰‡è³¼è²·ç‚ºé¡å¤–è£œå……è³‡è¨Šï¼Œä¸ä½µå…¥ç‡Ÿæ”¶èˆ‡ ARPUã€‚</b>
      ä¸‹æ–¹åœ–è¡¨å¯é€éå³ä¸Šè§’å‹¾é¸ï¼Œåˆ‡æ›è¦è§€å¯Ÿçš„ç¶­åº¦ã€‚
    </div>

    <div class="layout">
      <div class="card">
        <h2>æœˆåº¦æ¦‚æ³ç¸½è¡¨</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>æœˆä»½</th>
                <th>è¨‚é–±äººæ•¸</th>
                <th>å–®æœˆ%</th>
                <th>ä¸‰æœˆ%</th>
                <th>å…­æœˆ%</th>
                <th>è¨‚é–±æ•¸æˆé•·ç‡%</th>
                <th>æ–°å®¢</th>
                <th>èˆŠå®¢</th>
                <th>æ–°å®¢æ¯”ä¾‹%</th>
                <th>èˆŠå®¢æ¯”ä¾‹%</th>
                <th>ç‡Ÿæ”¶é‡‘é¡</th>
                <th>ç‡Ÿæ”¶æˆé•·ç‡%</th>
                <th>å–®ç‰‡è³¼è²·</th>
                <th>ARPU</th>
                <th>é•·æœŸæ–¹æ¡ˆä½”æ¯”%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>6 æœˆ</td><td>49</td><td>89.80%</td><td>0%</td><td>10.20%</td>
                <td>â€”</td><td>49</td><td>0</td><td>100%</td><td>0%</td>
                <td>10,887</td><td>â€”</td><td>$ 1,067</td><td>222.2</td><td>10.20%</td>
              </tr>
              <tr>
                <td>7 æœˆ</td><td>103</td><td>89.30%</td><td>5.80%</td><td>4.90%</td>
                <td>110.20%</td><td>94</td><td>9</td><td>91.30%</td><td>8.70%</td>
                <td>22,126</td><td>103.20%</td><td>$ 2,087</td><td>214.8</td><td>10.70%</td>
              </tr>
              <tr>
                <td>8 æœˆ</td><td>120</td><td>90%</td><td>1.70%</td><td>8.30%</td>
                <td>16.50%</td><td>88</td><td>32</td><td>73.30%</td><td>26.70%</td>
                <td>27,867</td><td>25.90%</td><td>$ 3,137</td><td>232.2</td><td>10%</td>
              </tr>
              <tr>
                <td>9 æœˆ</td><td>113</td><td>77.90%</td><td>6.20%</td><td>15.90%</td>
                <td>-5.80%</td><td>75</td><td>38</td><td>66.40%</td><td>33.60%</td>
                <td>31,699</td><td>13.80%</td><td>$ 2,357</td><td>280.5</td><td>22.10%</td>
              </tr>
              <tr>
                <td>10 æœˆ</td><td>98</td><td>93.90%</td><td>6.10%</td><td>0%</td>
                <td>-13.30%</td><td>57</td><td>41</td><td>58.20%</td><td>41.80%</td>
                <td>37,209</td><td>17.40%</td><td>$ 12,256</td><td>379.7</td><td>6.10%</td>
              </tr>
              <tr>
                <td>11 æœˆ</td><td>157</td><td>84.71%</td><td>15.29%</td><td>0%</td>
                <td>60.20%</td><td>80</td><td>77</td><td>50.96%</td><td>49.04%</td>
                <td>49,598</td><td>33.32%</td><td>$ 6,664</td><td>317.0</td><td>15.29%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="card chart-section">
        <div class="chart-header">
          <h2>äº’å‹•åœ–è¡¨</h2>
          <div class="chart-controls">
            <span class="chart-controls-label">é¡¯ç¤ºç¶­åº¦ï¼š</span>
            <label class="group-toggle">
              <input type="checkbox" id="toggle-subs" checked />
              <span>è¨‚é–±ï¼‹æ–°èˆŠå®¢</span>
            </label>
            <label class="group-toggle">
              <input type="checkbox" id="toggle-plans" checked />
              <span>æ–¹æ¡ˆæ¯”ä¾‹</span>
            </label>
            <label class="group-toggle">
              <input type="checkbox" id="toggle-revenue" checked />
              <span>ç‡Ÿæ”¶</span>
            </label>
            <label class="group-toggle">
              <input type="checkbox" id="toggle-single" checked />
              <span>å–®ç‰‡è³¼è²·</span>
            </label>
            <label class="group-toggle">
              <input type="checkbox" id="toggle-arpu" checked />
              <span>ARPU</span>
            </label>
          </div>
        </div>
        <canvas id="mainChart" height="190"></canvas>
        <div class="chart-legend-hint">
          ğŸ’¡ æç¤ºï¼šæ»‘é¼ ç§»åˆ°ä»»ä½•ä¸€å€‹é»ï¼Œå¯æŸ¥çœ‹è©²æœˆå°æ‡‰çš„äººæ•¸ / æ¯”ä¾‹ / é‡‘é¡ / ARPUã€‚
        </div>
      </div>

      <div class="card">
        <h2>å–®ç‰‡è³¼è²·æ‘˜è¦</h2>

        <div class="kpi-row">
          <span class="kpi-label">6â€“11 æœˆå–®ç‰‡ç¸½ç‡Ÿæ”¶ï¼š</span>
          <span class="kpi-value tag tag-sp">27,568 å…ƒ</span>
        </div>
        <div class="kpi-row">
          <span class="kpi-label">6â€“11 æœˆå–®ç‰‡ç¸½è¨‚å–®æ•¸ï¼š</span>
          <span class="kpi-value">209 ç­†</span>
        </div>
        <div class="kpi-row">
          <span class="kpi-label">å–®ç‰‡å¹³å‡å®¢å–®åƒ¹ï¼š</span>
          <span class="kpi-value">ç´„ 132 å…ƒ / ç­†</span>
        </div>
        <div class="kpi-row">
          <span class="kpi-label">å–®æœˆç‡Ÿæ”¶é«˜å³°ï¼š</span>
          <span class="kpi-value tag tag-total">10 æœˆï¼ˆ12,256 å…ƒ / 87 ç­†ï¼‰</span>
        </div>

        <p class="muted" style="margin-top: 10px; margin-bottom: 4px;">
          æœ€æš¢éŠ·å–®ç‰‡ä½œå“ï¼ˆä¾ç¸½ç‡Ÿæ”¶ï¼‰ï¼š
        </p>
        <div class="table-wrapper">
          <table>
            <thead><tr><th>ä½œå“åç¨±</th><th>å–®ç‰‡ç¸½ç‡Ÿæ”¶</th></tr></thead>
            <tbody>
              <tr><td>ç«è»Šç«™å»æ‰€å¹«å°» å…©éš»æ‰‹æ‰æ¡å¾—ä½ğŸ¥µ</td><td>2,899</td></tr>
              <tr><td>å¾®é†ºçš„æ°£æ°›ä¸‹ è¦ä¸è¦ä¾†æ ¹æ£’æ£’ç³–ğŸ­</td><td>2,100</td></tr>
              <tr><td>å°åŒ—ç ”ç©¶ç”Ÿæ”¾å­¸åœ¨å¹¹å˜›ï¼Ÿåƒé›é›ï¼ï¼</td><td>2,000</td></tr>
              <tr><td>å¥¶ç‹—é›ªç³•å™´å°„ è¢«å°»å°„é‚„ç¹¼çºŒåƒğŸ¥µ</td><td>1,232</td></tr>
              <tr><td>å¤§å±Œå¼Ÿå¼Ÿ åœè»Šå ´å¤§å™´å°„ å™´å¾—æ•´å°è»Šéƒ½æ˜¯æ´¨ğŸ’¦</td><td>1,201</td></tr>
            </tbody>
          </table>
        </div>
        <p class="muted">
          ä»¥ä¸Šé‡‘é¡çš†ç‚ºå¯¦éš›åˆ°æ‰‹æ”¶å…¥ï¼ˆå·²æ‰£é™¤å¹³å°æ‰‹çºŒè²»ï¼‰ã€‚
        </p>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const labels = ["Jun", "Jul", "Aug", "Sep", "Oct", "Nov"];

    // æ•¸æ“š
    const subs = [49, 103, 120, 113, 98, 157];
    const newUsers = [49, 94, 88, 75, 57, 80];
    const oldUsers = [0, 9, 32, 38, 41, 77];

    const subRevenue = [10887, 22126, 27867, 31699, 37209, 49598];
    const singleRevenue = [1067, 2087, 3137, 2357, 12256, 6664];

    const arpu = [222.2, 214.8, 232.2, 280.5, 379.7, 317.0];

    const singleRate = [89.8, 89.3, 90.0, 77.9, 93.9, 84.71];
    const threeRate  = [0.0, 5.8, 1.7, 6.2, 6.1, 15.29];
    const sixRate    = [10.2, 4.9, 8.3, 15.9, 0.0, 0.0];

    const ctx = document.getElementById("mainChart").getContext("2d");

    // å…¨éƒ¨ datasetsï¼Œä¸€é–‹å§‹éƒ½å»ºç«‹å¥½ï¼ŒåŠ ä¸Š group æ¨™ç±¤
    const allDatasets = [
      // è¨‚é–± & æ–°èˆŠå®¢ï¼šæŸ±ç‹€å †ç–Š
      {
        id: "subs_new",
        group: "subs",
        type: "bar",
        label: "New Users",
        data: newUsers,
        backgroundColor: "rgba(56,189,248,0.85)",
        borderRadius: 6,
        stack: "subsStack",
        yAxisID: "y"
      },
      {
        id: "subs_old",
        group: "subs",
        type: "bar",
        label: "Old Users",
        data: oldUsers,
        backgroundColor: "rgba(37,99,235,0.9)",
        borderRadius: 6,
        stack: "subsStack",
        yAxisID: "y"
      },

      // æ–¹æ¡ˆæ¯”ä¾‹ï¼š100% å †ç–ŠæŸ±ç‹€åœ–
      {
        id: "plan_1m",
        group: "plans",
        type: "bar",
        label: "1-Month %",
        data: singleRate,
        backgroundColor: "rgba(34,197,94,0.9)",
        stack: "planStack",
        yAxisID: "y"
      },
      {
        id: "plan_3m",
        group: "plans",
        type: "bar",
        label: "3-Month %",
        data: threeRate,
        backgroundColor: "rgba(168,85,247,0.9)",
        stack: "planStack",
        yAxisID: "y"
      },
      {
        id: "plan_6m",
        group: "plans",
        type: "bar",
        label: "6-Month %",
        data: sixRate,
        backgroundColor: "rgba(249,115,22,0.95)",
        stack: "planStack",
        yAxisID: "y"
      },

      // ç‡Ÿæ”¶ï¼šè¨‚é–±ç‡Ÿæ”¶æŠ˜ç·š
      {
        id: "rev_main",
        group: "revenue",
        type: "line",
        label: "Subscription Revenue",
        data: subRevenue,
        borderColor: "#f97373",
        backgroundColor: "rgba(248,113,113,0.18)",
        borderWidth: 3,
        tension: 0.35,
        pointRadius: 4,
        pointHoverRadius: 5,
        yAxisID: "y1"
      },

      // å–®ç‰‡è³¼è²·ï¼šå–®ç‰‡ç‡Ÿæ”¶æŠ˜ç·š
      {
        id: "single_rev",
        group: "single",
        type: "line",
        label: "Single-Purchase Revenue",
        data: singleRevenue,
        borderColor: "#eab308",
        backgroundColor: "rgba(234,179,8,0.2)",
        borderWidth: 2.5,
        tension: 0.35,
        pointRadius: 4,
        pointHoverRadius: 5,
        yAxisID: "y1"
      },

      // ARPU
      {
        id: "arpu_line",
        group: "arpu",
        type: "line",
        label: "ARPU",
        data: arpu,
        borderColor: "#4f46e5",
        backgroundColor: "rgba(79,70,229,0.25)",
        borderWidth: 3,
        tension: 0.35,
        pointRadius: 4,
        pointHoverRadius: 5,
        yAxisID: "y"
      }
    ];

    const chartConfig = {
      type: "bar",
      data: {
        labels,
        datasets: allDatasets.map(ds => ({ ...ds })) // clone
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        interaction: {
          mode: "nearest",
          intersect: false
        },
        plugins: {
          legend: {
            labels: {
              color: "#e5e7eb"
            }
          },
          tooltip: {
            enabled: true,
            callbacks: {
              label: function(ctx) {
                const label = ctx.dataset.label || "";
                const value = ctx.parsed.y;

                if (label.includes("%")) {
                  return label + ": " + value.toFixed(1) + " %";
                }
                if (label.toLowerCase().includes("revenue")) {
                  return label + ": " + value.toLocaleString() + " NTD";
                }
                if (label === "ARPU") {
                  return label + ": " + value.toFixed(1);
                }
                if (label.includes("Users")) {
                  return label + ": " + value;
                }
                return label + ": " + value;
              }
            }
          }
        },
        scales: {
          y: {
            position: "left",
            title: { display: true, text: "Count / % / ARPU", color: "#9ca3af" },
            grid: { color: "rgba(55,65,81,0.7)" },
            ticks: {
              color: "#9ca3af",
              callback: function(value) { return value; }
            },
            stacked: false
          },
          y1: {
            position: "right",
            title: { display: true, text: "Revenue (NTD)", color: "#9ca3af" },
            grid: { drawOnChartArea: false },
            ticks: {
              color: "#9ca3af",
              callback: function(value) { return value.toLocaleString(); }
            },
            stacked: false
          }
        }
      }
    };

    const mainChart = new Chart(ctx, chartConfig);

    // group checkbox æ§åˆ¶
    const groupCheckboxes = {
      subs: document.getElementById("toggle-subs"),
      plans: document.getElementById("toggle-plans"),
      revenue: document.getElementById("toggle-revenue"),
      single: document.getElementById("toggle-single"),
      arpu: document.getElementById("toggle-arpu")
    };

    function updateVisibility() {
      mainChart.data.datasets.forEach(ds => {
        const group = ds.group;
        const checkbox = groupCheckboxes[group];
        if (!checkbox) return;
        ds.hidden = !checkbox.checked;
      });

      // å·¦å´ y è»¸å †ç–Šé‚è¼¯ï¼šå¦‚æœåªçœ‹æ–¹æ¡ˆæ¯”ä¾‹ï¼Œæ‰ä½¿ç”¨å †ç–Šï¼ˆæ¯”è¼ƒä¹¾æ·¨ï¼‰
      const plansOn = groupCheckboxes.plans.checked;
      const subsOn = groupCheckboxes.subs.checked;
      if (plansOn && !subsOn) {
        mainChart.options.scales.y.stacked = true;
      } else {
        mainChart.options.scales.y.stacked = false;
      }

      mainChart.update();
    }

    Object.values(groupCheckboxes).forEach(cb => {
      cb.addEventListener("change", updateVisibility);
    });

    // åˆå§‹å¥—ç”¨ä¸€æ¬¡
    updateVisibility();
  </script>
</body>
</html>
